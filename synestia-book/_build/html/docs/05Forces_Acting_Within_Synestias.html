
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Forces Acting Within a Synestia &#8212; Synestias — An Interactive Primer</title>
    
  <link rel="stylesheet" href="../_static/css/index.d431a4ee1c1efae0e38bdfebc22debff.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.bfb7730f9caf2ec0b46a44615585038c.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.30270b6e4c972e43c488.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Gas Drag on Moons in Synestias" href="06Gas_Drag_on_Moons_in_Synestias.html" />
    <link rel="prev" title="How Do Synestias Form? (Giant Impacts)" href="04How_Do_Synestias_Form.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/synestia.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Synestias — An Interactive Primer</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="README.html">
   Preface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="README.html#abstract">
   Abstract
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="README.html#introduction">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01What_Are_Synestias.html">
   What Are Synestias?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02Physical_Properties_of_Synestias.html">
   Physical Properties of Synestias
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03What_Determines_Whether_a_Planetary_Structure_is_a_Synestia.html">
   What determines whether a planetary object is a synestia?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04How_Do_Synestias_Form.html">
   How Do Synestias Form? (Giant Impacts)
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Forces Acting Within a Synestia
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06Gas_Drag_on_Moons_in_Synestias.html">
   Gas Drag on Moons in Synestias
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07Orbital_Dynamics_Within_Synestias.html">
   Orbital Dynamics Within Synestias
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Appendices.html">
   Appendices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MoreInformation.html">
   More Information about Synestias
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="AboutThisBook.html">
   About this book
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/05Forces_Acting_Within_Synestias.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ststewart/synestiabook2/master?urlpath=tree/synestia-book/docs/05Forces_Acting_Within_Synestias.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/ststewart/synestiabook2/blob/master/synestia-book/docs/05Forces_Acting_Within_Synestias.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#balance-of-forces">
   Balance of Forces
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gravity">
     Gravity
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pressure-force">
     Pressure Force
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sub-keplerian-orbits-of-moonlets-in-synestias-balanced-by-oblate-gravity-and-pressure">
   Sub-Keplerian Orbits of Moonlets in Synestias: Balanced by Oblate Gravity and Pressure}
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#oblate-gravity-term">
     Oblate Gravity Term
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#satellite-s-mass">
       Satellite’s Mass
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#semi-major-axis-of-orbit">
       Semi-Major Axis of Orbit
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#inclination-of-orbit">
       Inclination of Orbit
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#eccentricity-of-orbit">
       Eccentricity of Orbit
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pressure-term">
     Pressure Term
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#hydrostatic-equilibrium">
       Hydrostatic Equilibrium
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p>Before reading this Jupyter Notebook, it may be helpful to review <a class="reference internal" href="Keplerian_Orbit.html"><span class="doc std std-doc">Keplerian orbits</span></a>.</p>
<div class="section" id="forces-acting-within-a-synestia">
<h1>Forces Acting Within a Synestia<a class="headerlink" href="#forces-acting-within-a-synestia" title="Permalink to this headline">¶</a></h1>
<div class="section" id="balance-of-forces">
<h2>Balance of Forces<a class="headerlink" href="#balance-of-forces" title="Permalink to this headline">¶</a></h2>
<p><img alt="title" src="../_images/FigureGasForces.png" /></p>
<p><i>Caption</i>. There are three forces acting on gas in a synestia. As gas in a synestia rotates with angular velocity <span class="math notranslate nohighlight">\(\omega\)</span>, a centripetal force acts on the gas. Gravitational and pressure forces act on the gas as well. The mass of the material closest to the rotational axis will attract the gas towards the center of a synestia. However, gravitational acceleration of the gas a<span class="math notranslate nohighlight">\(_{grav}\)</span> in z is balanced by a vertical pressure force dP/dr that acts over the local pressure gradients in the gas. Thus, there is rotational but no vertical (z) motion of the gas. Credit: S. J. Lock and G. O. Hollyday.</p>
<p>To understand the dynamics of a synestia, we must first understand its mechanics (balance of forces). There are three forces at work (see image above):</p>
<ol class="simple">
<li><p>centripetal force (arises from curving motion),</p></li>
<li><p>pressure force from the gas, and</p></li>
<li><p>gravity of components of the structure.</p></li>
</ol>
<p>A parcel of gas in a synestia is stably orbiting when it follows the following equation:</p>
<div class="math notranslate nohighlight">
\[\omega^2r = \frac{1}{\rho}\frac{dP}{dr} + \frac{GM}{r^2} \left(1 - \frac{3J_2a_{eq}^2}{2r^2}\left(\frac{3z^2}{r^2} - 1\right) \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\omega\)</span> is the angular velocity of the parcel, r is the distance from the parcel to the center of the synestia (origin), <span class="math notranslate nohighlight">\(\rho\)</span> is the density of the parcel of gas, dP/dr is the radial pressure gradient at the location of the parcel, G is the gravitational constant, M is the mass of the synestia the parcel is orbiting in, J<span class="math notranslate nohighlight">\(_2\)</span> is the oblateness of that synestia, a<span class="math notranslate nohighlight">\(_{eq}\)</span> is the equatorial radius of this synestia, and z is the vertical distance off the midplane of the parcel of gas. In a synestia, the presence of gas everywhere and the placement of mass at extended distances in the midplane add the radial pressure gradient and gravitational J<span class="math notranslate nohighlight">\(_2\)</span> term to the balance of forces for an orbit. For comparison, a Keplerian orbit for a spherical central mass follows:</p>
<div class="math notranslate nohighlight">
\[\omega^2r = \frac{GM}{r^2}\]</div>
<p>A parcel of gas is in equilibrium when the gravitational force, pressure force, and curving motion are balanced so that the particle maintains a stable orbit. The angular velocity of a parcel of gas in equilibrium  will change according to the strength of the gravitational field and the pressure gradient surrounding it in a synestia. The gas density, gas pressure, and self-gravitation (J<span class="math notranslate nohighlight">\(_2\)</span> gravity term) are significant forces in shaping the oblate, flared gas structure of a synestia and motion of moonlets inside a synestia.</p>
<div class="section" id="gravity">
<h3>Gravity<a class="headerlink" href="#gravity" title="Permalink to this headline">¶</a></h3>
<p>Gravitational forces increase with increasing radius, increasing oblateness, and total mass. When the gravitational forces are stronger, the gas particles inside a synestia must have higher angular velocity to maintain a stable orbit.</p>
<p>The strongest gravitational forces will be along the midplane and closest to the center of a synestia. Both are considered equilibrium points (where a particle will settle when forces are balanced). In constrast, a  gas parcel at a greater distance from the rotation axis and farther from the midplane will experience a lower gravitational force.</p>
</div>
<div class="section" id="pressure-force">
<h3>Pressure Force<a class="headerlink" href="#pressure-force" title="Permalink to this headline">¶</a></h3>
<p>The pressure force, (1/<span class="math notranslate nohighlight">\(\rho\)</span>)(dP/dr), is dependent on the synestia’s vapor density and pressure gradients.</p>
<p>Pressure and density of the gas will vary based on the parcel’s location in a synestia. There is a radial dependency for pressure and density. Pressure and density decrease off the midplane to higher z, and also decrease at larger distances (cylindrical radius, r<span class="math notranslate nohighlight">\(_{xy}\)</span>) from a synestia’s rotational axis. Pressure and density follow a negative power law dependence in r<span class="math notranslate nohighlight">\(_{xy}\)</span> and an exponential decay dependence in z.</p>
<p>Pressure will typically follow the form:</p>
<div class="math notranslate nohighlight">
\[P = P(r_{xy}, z) = P_0r_{xy}^{-a}e^{-z^2/z_s^2}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_0\)</span> is a reference pressure in the midplane, r<span class="math notranslate nohighlight">\(_{xy}\)</span> is the cylindrical radius of the gas parcel and makes the base of the power law fit for the midplane, a is the positive exponent of the midplane’s power law fit, z is the vertical position of the parcel of gas, and z<span class="math notranslate nohighlight">\(_s\)</span> is the <i>scale height</i>.</p>
<p>The scale height is a measure of how quickly the density decreases in z. The scale height is the z at which density reaches 1/e<i>th</i> of its midplane value. The scale height has a power law dependency on cylindrical radius r<span class="math notranslate nohighlight">\(_{xy}\)</span> with the form:</p>
<div class="math notranslate nohighlight">
\[z_s = b r_{xy}^d\]</div>
<p>where b is a positive coefficient and d is the positive exponent of the power law.</p>
<p>Similarly, density will typically follow the form:</p>
<div class="math notranslate nohighlight">
\[\rho = \rho(r_{xy}, z) = \rho_0r_{xy}^{-f}e^{-z^2/z_s^2}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho_0\)</span> is a reference density in the midplane and f is the positive exponent of the midplane’s power law fit.</p>
<p>Essentially, gas density and pressure exponentially decay from the midplane to the photosphere (cloud layer) of a synestia, and will do so more quickly at larger distances from a synestia’s rotational axis. In the midplane, gas density and pressure decrease with increasing cylindrical radius according to some power law. This shapes a synestia’s pressure and density fields into nested, flared contours.</p>
<p>The greater the density of the gas field and the pressure differential across the gas parcel [one side of the gas particle (smaller radius) has a much stronger pressure than the other side (larger radius)], the larger the pressure support will be for an orbiting gas particle. With increased pressure support, a gas parcel can orbit stably at lower angular velocities. We call these <i>sub-Keplerian</i> orbits.</p>
</div>
</div>
<div class="section" id="sub-keplerian-orbits-of-moonlets-in-synestias-balanced-by-oblate-gravity-and-pressure">
<h2>Sub-Keplerian Orbits of Moonlets in Synestias: Balanced by Oblate Gravity and Pressure}<a class="headerlink" href="#sub-keplerian-orbits-of-moonlets-in-synestias-balanced-by-oblate-gravity-and-pressure" title="Permalink to this headline">¶</a></h2>
<div class="section" id="oblate-gravity-term">
<h3>Oblate Gravity Term<a class="headerlink" href="#oblate-gravity-term" title="Permalink to this headline">¶</a></h3>
<p>The Keplerian orbit of a moonlet within the (first and second order) gravity field of an Earth-mass synestia is shown in the interactive below. You can change the parameters of the Keplerian orbit. You will see how a moon travels when only a synestia’s gravity (first and second order) is at play (no gas), so that we have a baseline to compare to when gas drag is taken into account. The oblateness of a synestia’s gravity field is non-negligible. A synestia’s gravity field has extra gravitational acceleration closest to both the midplane and center of a synestia due to the oblateness of a synestia. Notice how any orbits off the midplane are affected by the J<span class="math notranslate nohighlight">\(_2\)</span> term in a synestia’s gravity.</p>
<p>You may have to be patient while the plots load. If there is output but no images, re-run the notebook. If the plots do not load after 1-2 minutes, restart the notebook.</p>
<div class="margin sidebar">
<p class="sidebar-title">Running a code cell</p>
<p>Access interactive features by ‘Launch CoLab’ or ‘Launch Binder’ from the rocket logo at the top of the page. When the interactive environment is ready, place your cursor in the code cell and press shift-return to execute the code. If using CoLab (loads faster), you need to edit the code cell as directed to install rebound.</p>
</div>
<p>Click the + symbol to see the code that generates the next interactive feature.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Dear Reader: If using CoLab, remove the # from the line below and shift-return to install rebound</span>

<span class="c1">#!pip install rebound</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rebound</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">dens</span> <span class="o">=</span> <span class="mf">3000.</span> <span class="c1">#kg/m^3</span>
<span class="n">G_hr</span><span class="o">=</span><span class="p">(</span><span class="mf">6.674e-11</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3600</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#gravitational constant converted to m^3 kg^-1 hr^-2</span>

<span class="c1"># stsm -- do not need to load the model files here</span>
<span class="c1">#from syndef import synfits #import synestia snapshot (impact database)</span>
<span class="c1">#Mass_syn=np.sum(synfits.SNAP_CukStewart.m) #Earth mass synestia in kg</span>
<span class="c1">#J2Ma2 = synfits.SNAP_Canup.J2Ma2</span>
<span class="c1">#print(Mass_syn)</span>
<span class="c1">#print(J2Ma2)</span>
<span class="n">Mass_syn</span><span class="o">=</span><span class="mf">5.970890871119314e+24</span>
<span class="n">J2Ma2</span><span class="o">=</span><span class="mf">9.294291884637224e+37</span>

<span class="c1">#from rebound.plotting import fading_line</span>
<span class="k">def</span> <span class="nf">pltJ2</span><span class="p">(</span><span class="n">rad_moon</span><span class="p">,</span><span class="n">sma</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">ecc</span><span class="p">):</span>
    <span class="c1">#rad_moon is the bodily radius of the moon</span>
    <span class="c1">#i is the inclination of the moon&#39;s orbital plane</span>
    <span class="c1">#sma is the semi-major axis of the moon&#39;s orbit</span>
    <span class="c1">#ecc is the eccentricity of the moon&#39;s orbit</span>
    <span class="n">m_moon</span> <span class="o">=</span> <span class="mf">4.</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">dens</span><span class="o">*</span><span class="p">(</span><span class="n">rad_moon</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">3.</span>
    <span class="n">sim_kep</span> <span class="o">=</span> <span class="n">rebound</span><span class="o">.</span><span class="n">Simulation</span><span class="p">()</span> <span class="c1">#start simulation</span>
    <span class="n">sim_kep</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Hr&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;Kg&#39;</span><span class="p">)</span> <span class="c1">#use SI units</span>
    <span class="n">sim_kep</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">Mass_syn</span><span class="p">)</span> <span class="c1">#add central body</span>
    <span class="n">sim_kep</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m_moon</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">sma</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">e</span><span class="o">=</span><span class="n">ecc</span><span class="p">)</span>
    <span class="n">sim_kep</span><span class="o">.</span><span class="n">move_to_com</span><span class="p">()</span>
    <span class="n">ps_kep</span> <span class="o">=</span> <span class="n">sim_kep</span><span class="o">.</span><span class="n">particles</span>
    <span class="n">kep_moon</span> <span class="o">=</span> <span class="n">ps_kep</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">kep_orbit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">kep_moon</span><span class="o">.</span><span class="n">sample_orbit</span><span class="p">())</span>
    
    <span class="n">sim_j2</span> <span class="o">=</span> <span class="n">rebound</span><span class="o">.</span><span class="n">Simulation</span><span class="p">()</span> <span class="c1">#start simulation</span>
    <span class="n">sim_j2</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Hr&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;Kg&#39;</span><span class="p">)</span> <span class="c1">#use SI units</span>
    <span class="n">sim_j2</span><span class="o">.</span><span class="n">min_dt</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1">#prevents time step from getting too small</span>
    <span class="n">sim_j2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">Mass_syn</span><span class="p">)</span> <span class="c1">#add central body</span>
    <span class="n">sim_j2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m_moon</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">sma</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">e</span><span class="o">=</span><span class="n">ecc</span><span class="p">)</span>
    <span class="n">ps_j2</span> <span class="o">=</span> <span class="n">sim_j2</span><span class="o">.</span><span class="n">particles</span>
    
    <span class="k">def</span> <span class="nf">J2</span><span class="p">(</span><span class="n">sim_j2</span><span class="p">):</span>
        <span class="n">r_orb</span> <span class="o">=</span> <span class="p">(</span><span class="n">ps_j2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ps_j2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ps_j2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="n">costheta</span> <span class="o">=</span> <span class="n">ps_j2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">z</span><span class="o">/</span><span class="n">r_orb</span>
        <span class="n">grav2</span> <span class="o">=</span> <span class="mf">3.0</span><span class="o">*</span><span class="n">G_hr</span><span class="o">*</span><span class="n">J2Ma2</span><span class="o">*</span><span class="p">(</span><span class="n">r_orb</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">ps_j2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ax</span> <span class="o">-=</span> <span class="n">ps_j2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="n">grav2</span><span class="o">*</span><span class="p">(</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">costheta</span><span class="o">*</span><span class="n">costheta</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="p">)</span>
        <span class="n">ps_j2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ay</span> <span class="o">-=</span> <span class="n">ps_j2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="o">*</span><span class="n">grav2</span><span class="o">*</span><span class="p">(</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">costheta</span><span class="o">*</span><span class="n">costheta</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="p">)</span>
        <span class="n">ps_j2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">az</span> <span class="o">-=</span> <span class="n">ps_j2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">z</span><span class="o">*</span><span class="n">grav2</span><span class="o">*</span><span class="p">(</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">costheta</span><span class="o">*</span><span class="n">costheta</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="p">)</span>
    
    <span class="n">sim_j2</span><span class="o">.</span><span class="n">additional_forces</span> <span class="o">=</span> <span class="n">J2</span>
    <span class="n">sim_j2</span><span class="o">.</span><span class="n">move_to_com</span><span class="p">()</span>
    
    <span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># number of integration points</span>
    <span class="c1"># for more inclined or eccentric orbits,</span>
    <span class="c1"># for larger orbits,</span>
    <span class="c1"># need more integration time</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mf">1.</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ecc</span> <span class="o">&gt;</span> <span class="mf">0.6</span><span class="p">)):</span>
        <span class="n">t_final</span> <span class="o">=</span> <span class="mf">100.</span> <span class="c1">#hr</span>
    <span class="k">elif</span> <span class="p">((</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mf">0.2</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ecc</span> <span class="o">&gt;</span> <span class="mf">0.3</span><span class="p">)):</span>
        <span class="n">t_final</span> <span class="o">=</span> <span class="mf">50.</span> <span class="c1">#hr</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">sma</span> <span class="o">&gt;</span> <span class="mf">30000000.</span><span class="p">):</span>
        <span class="n">t_final</span> <span class="o">=</span> <span class="mf">100.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">t_final</span> <span class="o">=</span> <span class="mf">20.</span> <span class="c1">#hr</span>
    <span class="n">j2_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="c1">#m</span>
    <span class="n">j2_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="c1">#m</span>
    <span class="n">j2_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="c1">#m</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">t_final</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="c1">#hr</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">time</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
        <span class="n">sim_j2</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">j2_x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">ps_j2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span>
        <span class="n">j2_y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">ps_j2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span>
        <span class="n">j2_z</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">ps_j2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">z</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;k*&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">j2_x</span><span class="p">,</span><span class="n">j2_y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kep_orbit</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">kep_orbit</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">j2_x</span><span class="p">,</span> <span class="n">j2_z</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gravity with J$_2$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kep_orbit</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">kep_orbit</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Keplerian&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;k*&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;z (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">j2_y</span><span class="p">,</span> <span class="n">j2_z</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kep_orbit</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">kep_orbit</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;k*&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;y (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;z (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
<span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">}</span>
<span class="n">layout</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;400px&#39;</span><span class="p">}</span>
<span class="n">interact</span><span class="p">(</span><span class="n">pltJ2</span><span class="p">,</span>
         <span class="n">rad_moon</span><span class="o">=</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Body radius of moonlet (m)&#39;</span><span class="p">,</span>
                            <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">readout_format</span><span class="o">=</span><span class="s1">&#39;.1f&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">),</span>
         <span class="n">sma</span><span class="o">=</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">20e6</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">10e6</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">60e6</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">10e6</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Semi-major axis (m)&#39;</span><span class="p">,</span>
                        <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">readout_format</span><span class="o">=</span><span class="s1">&#39;.1f&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">),</span>
         <span class="n">i</span><span class="o">=</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Inclination of orbit (radians)&#39;</span><span class="p">,</span>
                        <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">readout_format</span><span class="o">=</span><span class="s1">&#39;.1f&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">),</span>
         <span class="n">ecc</span><span class="o">=</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Eccentricity of orbit (unitless)&#39;</span><span class="p">,</span>
                        <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">readout_format</span><span class="o">=</span><span class="s1">&#39;.1f&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">),</span>
         <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/05Forces_Acting_Within_Synestias_7_0.png" src="../_images/05Forces_Acting_Within_Synestias_7_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function __main__.pltJ2(rad_moon, sma, i, ecc)&gt;
</pre></div>
</div>
</div>
</div>
<p><i>Caption</i>. The effect of the J<span class="math notranslate nohighlight">\(_2\)</span> gravity term on Keplerian orbits within an Earth-mass synestia. The equivalent Keplerian orbit (first order gravity only) is shown for reference in grey, with the central mass indicated by a black star.</p>
<p>For cases mentioned below, unless otherwise stated, the default settings are: “Semi-major axis” of 20,000,000 m, “Inclination of orbit” of 0 radians, and “Eccentricity of orbit” of 0.</p>
<div class="section" id="satellite-s-mass">
<h4>Satellite’s Mass<a class="headerlink" href="#satellite-s-mass" title="Permalink to this headline">¶</a></h4>
<p>Similar to a first order Keplerian orbit, changing the size of the satellite (“Body radius of moonlet” in interactive above) does not affect the trajectory of its gravitationally balanced orbit. The second-order gravity term affects the orbit of the moon only near certain locations (e.g. at smaller radii nearest the midplane). Due to the second-order gravity term, the orbit of a moon in a synestia precesses.</p>
</div>
<div class="section" id="semi-major-axis-of-orbit">
<h4>Semi-Major Axis of Orbit<a class="headerlink" href="#semi-major-axis-of-orbit" title="Permalink to this headline">¶</a></h4>
<p>The moon’s orbit significantly deviates from its corresponding first order Keplerian orbit in orbits with a smaller semi-major axis (“Semi-major axis” of 20,000,000 m in interactive above). As the semi-major axis of the moon’s orbit grows (and the moon moves farther away from the central body), the J<span class="math notranslate nohighlight">\(_2\)</span> term is not as strong (compare with a “Semi-major axis” of 60,000,000 m in interactive above). Since the oblate gravity affects the orbit less at larger radii, the moon orbits much closer to the corresponding Keplerian orbit.</p>
</div>
<div class="section" id="inclination-of-orbit">
<h4>Inclination of Orbit<a class="headerlink" href="#inclination-of-orbit" title="Permalink to this headline">¶</a></h4>
<p>As the inclination of the moon’s orbit approaches 45<span class="math notranslate nohighlight">\(^{\circ}\)</span> [“Inclination of orbit” set to 0.4 radians (about 23<span class="math notranslate nohighlight">\(^{\circ}\)</span>) in interactive above] and 135<span class="math notranslate nohighlight">\(^{\circ}\)</span>, the moon’s orbit rotates, so that the farthest distance from the central body in the orbit changes (x,y) position with time. As the moon passes through the midplane on an inclined orbit, the increase in the J<span class="math notranslate nohighlight">\(_2\)</span> gravity term nudges the moonlet outward (a small increase in distance from the central body, r<span class="math notranslate nohighlight">\(_{xy}\)</span>). This helps turn the moon’s orbit about the central body’s rotational axis. If the moon’s orbital inclination is 90<span class="math notranslate nohighlight">\(^{\circ}\)</span> (“Inclination of orbit” set to 1.6 radians in interactive above), then the moon’s precession is not as strong. When the moon’s orbit transverses the rotational axis (r<span class="math notranslate nohighlight">\(_{xy}\)</span> = 0), the moon will not experience a contribution from the second-order gravity term, compared to when the moon passes through the midplane (along the equator, the most oblate portion of the central body) where the J<span class="math notranslate nohighlight">\(_2\)</span> gravity term is strongest. The lack of contribution at (r<span class="math notranslate nohighlight">\(_{xy}\)</span> = 0) counterbalanced by off and through the midplane motion causes the moon to orbit at an approximately first-order Keplerian orbit.</p>
</div>
<div class="section" id="eccentricity-of-orbit">
<h4>Eccentricity of Orbit<a class="headerlink" href="#eccentricity-of-orbit" title="Permalink to this headline">¶</a></h4>
<p>Increasing the eccentricity of the moon’s orbit will also rotate the orbit about the central body’s rotational axis. As the moon moves through the region where J<span class="math notranslate nohighlight">\(_2\)</span> gravity is significant and back out into a region where it is not, the moon will overshoot its orbit a bit and this moves the orbit over. Over time, this allows the orbit to rotate within the midplane (set “Eccentricity of orbit” to 0.5 in interactive above). The overshoot can be significant as the orbit’s eccentricity increases. If the eccentricity of the moon’s orbit is too high, the moon will escape the gravity of the central body and fly off the plot (set “Eccentricity of orbit” to 0.7 in interactive above). An eccentric orbit sends the moon into a region of a synestia where oblate gravity is essentially negligible then back again into a region where oblate gravity has a significant effect on the moon’s trajectory. This means that the magnitude of gravitational force acting upon the moon changes greatly throughout its orbit, which can destabilize the orbit to a varying degree, based on the eccentricity of the orbit. The larger the eccentricity, the larger the variation, and the more likely destabilization will happen (quickly).</p>
</div>
</div>
<div class="section" id="pressure-term">
<h3>Pressure Term<a class="headerlink" href="#pressure-term" title="Permalink to this headline">¶</a></h3>
<p>In a synestia, the presence of gas adds a dP/dr term to the balance of forces and makes the orbit of a parcel of gas sub-Keplerian. In other words, the angular velocity is lower than what it would be for a Keplerian orbit.</p>
<p>To maintain a stable elliptical orbit (forces are balanced, no inward/outward spiralling), an orbiting body must move fast enough around its central body to resist the inward pull of the total sum of forces (typically gravity, but pressure also acts in a synestia). For a Keplerian orbit, the only force that is acting (and is balanced) is gravity. In the non-corotating region of a synestia, a parcel of gas experiences a sub-Keplerian orbit. There is sufficient pressure support to counteract gravity in z and lessen the strength of gravity in the r<span class="math notranslate nohighlight">\(_{xy}\)</span> direction. The strength of the sum of inward forces is less than it would be for a Keplerian orbit. This allows the gas in a synestia to orbit at an angular velocity that is slower than it would be for an equivalent Keplerian orbit.</p>
<p>Take a look at the interactive below for the angular velocity profile (red) corresponding to the sub-Keplerian orbit of gas particles in the midplane at various cylindrical radii within a synestia. The corresponding Keplerian angular velocity profile is plotted as a dashed grey line for reference. Feel free to change the pressure term multiplier. The higher the multiplier, the stronger the pressure support will be.</p>
<p>Click the + symbol to see the code that generates the next interactive feature.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_hr</span><span class="o">=</span><span class="p">(</span><span class="mf">6.674e-11</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3600</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#gravitational constant converted to m^3 kg^-1 hr^-2</span>
<span class="n">Mass_syn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">synfits</span><span class="o">.</span><span class="n">SNAP_CukStewart</span><span class="o">.</span><span class="n">m</span><span class="p">)</span> <span class="c1">#Earth mass synestia in kg</span>
<span class="n">J2Ma2</span> <span class="o">=</span> <span class="n">synfits</span><span class="o">.</span><span class="n">SNAP_Canup</span><span class="o">.</span><span class="n">J2Ma2</span>
<span class="n">const1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.</span> <span class="c1">#coefficient of pressure gradient fit</span>
<span class="n">const2</span> <span class="o">=</span> <span class="mf">57.4</span> <span class="c1">#exponent of pressure gradient fit</span>
<span class="n">const5</span> <span class="o">=</span> <span class="mf">10.55</span> <span class="c1">#coefficient of density height fit</span>
<span class="n">const6</span> <span class="o">=</span> <span class="mf">0.86</span> <span class="c1">#exponent of density scale height fit</span>
<span class="n">const3</span> <span class="o">=</span> <span class="mf">0.9e35</span> <span class="c1">#coefficient of density midplane fit</span>
<span class="n">const4</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.7</span> <span class="c1">#exponent of density scale midplane fit</span>

<span class="k">def</span> <span class="nf">omgJ2Press</span><span class="p">(</span><span class="n">Pmultiplier</span><span class="p">,</span><span class="n">rxy_orbit</span><span class="p">):</span>
    <span class="n">cosO</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">grav</span> <span class="o">=</span> <span class="o">-</span><span class="n">G_hr</span><span class="o">*</span><span class="n">Mass_syn</span><span class="o">*</span><span class="p">(</span><span class="n">rxy_orbit</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">G_hr</span><span class="o">*</span><span class="n">J2Ma2</span><span class="o">*</span><span class="p">(</span><span class="n">rxy_orbit</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">cosO</span><span class="o">*</span><span class="n">cosO</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span>
    <span class="n">zsfit</span> <span class="o">=</span> <span class="n">const5</span><span class="o">*</span><span class="p">(</span><span class="n">rxy_orbit</span><span class="o">**</span><span class="n">const6</span><span class="p">)</span>
    <span class="n">rhofit</span> <span class="o">=</span> <span class="n">const3</span><span class="o">*</span><span class="p">(</span><span class="n">rxy_orbit</span><span class="o">**</span><span class="n">const4</span><span class="p">)</span>
    <span class="n">Pfactor</span> <span class="o">=</span> <span class="n">Pmultiplier</span><span class="o">*</span><span class="n">const1</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">const2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">rxy_orbit</span><span class="o">**</span><span class="p">(</span><span class="n">const1</span><span class="o">-</span><span class="mf">1.</span><span class="p">))</span><span class="o">/</span><span class="n">rhofit</span> <span class="c1">#*Pmultiplier</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">Pfactor</span> <span class="o">-</span> <span class="n">grav</span><span class="p">)</span><span class="o">/</span><span class="n">rxy_orbit</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">pltomg</span><span class="p">(</span><span class="n">Pmult</span><span class="p">):</span>
    <span class="n">rxy</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e7</span><span class="p">,</span><span class="mf">6e7</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span> <span class="c1">#m</span>
    <span class="n">omg</span><span class="o">=</span><span class="n">omgJ2Press</span><span class="p">(</span><span class="n">Pmult</span><span class="p">,</span><span class="n">rxy</span><span class="p">)</span> <span class="c1">#hr^-1</span>
    <span class="n">omg_Kep</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">G_hr</span><span class="o">*</span><span class="n">Mass_syn</span><span class="o">/</span><span class="p">(</span><span class="n">rxy</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span> <span class="c1">#hr^-1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rxy</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">omg</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pressure supported orbit with J$_2$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rxy</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">omg_Kep</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Keplerian orbit&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Cylindrical Radius r$_</span><span class="si">{xy}</span><span class="s1">$ (km)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Angular Velocity $\omega$ (hr$^{-1}$)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
<span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">}</span>
<span class="n">layout</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;400px&#39;</span><span class="p">}</span>
<span class="n">interact</span><span class="p">(</span><span class="n">pltomg</span><span class="p">,</span>
         <span class="n">Pmult</span><span class="o">=</span><span class="n">FloatLogSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">step</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Pressure term multiplier&#39;</span><span class="p">,</span>
                        <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">readout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">readout_format</span><span class="o">=</span><span class="s1">&#39;.1f&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">),</span>
         <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "5fdeae022db64cd8985ab606e142bcb6", "version_major": 2, "version_minor": 0}
</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function __main__.pltomg(Pmult)&gt;
</pre></div>
</div>
</div>
</div>
<p><i>Caption</i>. Pressure support in a synestia allows gas (red line) to travel at sub-Keplerian velocities (grey line). Angular velocities of the gas in a synestia will not change with distance off the midplane.</p>
<p>The pressure support allows the gas to orbit at angular velocities slower than their Keplerian equivalent. The higher the pressure support, the greater the disparity between the sub-Keplerian (synestia) and Keplerian angular velocity profiles.</p>
<p>It is not shown in plot above, but at smaller radii (<span class="math notranslate nohighlight">\(&lt;\)</span> 10,000 km), the angular velocity profile is flat. This is the corotating region. It is a region of maximum angular velocity in a synestia where all material rotates about the body’s axis with the same (rapid) angular velocity. At larger radii, the profile drops off, where material in a synestia can no longer corotate. There is a smooth transition between the corotating region (<span class="math notranslate nohighlight">\(&lt;\)</span> 10,000 km) of a synestia and the disk-like region (<span class="math notranslate nohighlight">\(&gt;\)</span> 10,000 km). The angular velocity profile of a synestia is continuous because there are no dynamically distinct features of a synestia. It is a connected body. In the disk-like region of a synestia, due to a strong pressure gradient at smaller radii, the angular velocities of gas rotating in a synestia will be more sub-Keplerian than gas at larger radii (which is nearly Keplerian).</p>
<div class="section" id="hydrostatic-equilibrium">
<h4>Hydrostatic Equilibrium<a class="headerlink" href="#hydrostatic-equilibrium" title="Permalink to this headline">¶</a></h4>
<p><img alt="FigHydrostaticEquil.png" src="../_images/FigHydrostaticEquil.png" /></p>
<p><i>Caption</i>. A parcel of fluid in a synestia (dark grey square, upper left) is in hydrostatic equilibrium in z if its gravitational (g<span class="math notranslate nohighlight">\(_z\)</span>) and pressure forces (dP/<span class="math notranslate nohighlight">\(\rho\)</span> dz) are equal. The black contours represent surfaces of constant pressure, where contours farthest from the origin have the lowest pressure values. Hydrostatic equilibrium defines the curvature of the pressure contours, which give synestias their flared shape. Credit: G. O. Hollyday.</p>
<p>The z component of the pressure gradient in a synesetia allows a gas particle to orbit at the same z. In other words, gas parcels experience <i>hydrostatic equilibrium</i> in the z direction. The gravitational pull towards the midplane due to a parcel of gas is balanced by the vertical pressure gradient. Gas parcels will not move in the z direction; they have zero movement in z. As a result, the gas velocities at a given cylindrical radius have the same magnitude (see <a class="reference internal" href="Poincare_Wavre.html"><span class="doc std std-doc">Poincarè-Wavre Theorem</span></a>). Hydrostatic equilibrium in z follows this equation:</p>
<div class="math notranslate nohighlight">
\[\frac{dP}{dz} = -\rho g_z = -\rho(r_{xy}, z)\frac{GMz}{r^3}\left(1 - \frac{3J_2a_{eq}^2}{r^2}\left(\frac{2.5z^2}{r^2} - 1.5\right)\right)\]</div>
<p>where g<span class="math notranslate nohighlight">\(_z\)</span> is the z component of the gravitational acceleration acting at a particular location r = (x, y, z) in a synestia with equatorial radius a<span class="math notranslate nohighlight">\(_{eq}\)</span>, total mass M, and J<span class="math notranslate nohighlight">\(_2\)</span> factor based on its mass distribution (oblateness).</p>
<p>The magnitude of the pressure gradient in z of the gas in a synestia will change according to the magnitude of the gas density and gravitational acceleration in z at a particular r<span class="math notranslate nohighlight">\(_{xy}\)</span> = (x,y), z location. The pressure gradient term in the balance of forces in a synestia causes a synestia to flare, taking on a disk-like shape.</p>
<p><i>Pressure contours</i>, or constant pressure surfaces, define a synestia’s flared shape. You can think of a synestia’s pressure field as many nested pressure contours, like Matryoshka nesting dolls, where the innermost contour has the highest pressure and the outermost contour has the lowest pressure. The difference in pressure between contours creates a pressure gradient.</p>
<p>A synestia is in hydrostatic equilibrium in z in its moon-forming region, so vertical pressure gradient forces are balanced by gravitational attraction towards the midplane. To first order, gravity decreases by r<span class="math notranslate nohighlight">\(^{-2}\)</span> with increasing radial distance from the center of a synestia. Pressure and density gradients decrease exponentially with distance from a synestia’s rotational axis. For a given z, the values of <span class="math notranslate nohighlight">\(\rho\)</span> and g will be lower at a larger r<span class="math notranslate nohighlight">\(_{xy}\)</span>.</p>
<p>Say we picked two pressure contours in a synestia, where dP is the difference in pressure between the two (see image above). If we selected some cylindrical radius r<span class="math notranslate nohighlight">\(_{xy,A}\)</span>, where <span class="math notranslate nohighlight">\(\rho_A\)</span> is the density and g<span class="math notranslate nohighlight">\(_A\)</span> is the gravitational acceleration at the higher pressure contour, then the vertical distance between the two pressure contours would be dz<span class="math notranslate nohighlight">\(_A\)</span>. If we then focused on a larger cylindrical radius r<span class="math notranslate nohighlight">\(_{xy,B}\)</span>, where r<span class="math notranslate nohighlight">\(_{xy,B}\)</span> <span class="math notranslate nohighlight">\(&gt;\)</span> r<span class="math notranslate nohighlight">\(_{xy,A}\)</span>, then the density and gravitational acceleration at the higher pressure contour would be smaller such that <span class="math notranslate nohighlight">\(\rho_B\)</span> <span class="math notranslate nohighlight">\(&lt;\)</span> <span class="math notranslate nohighlight">\(\rho_A\)</span> and g<span class="math notranslate nohighlight">\(_B\)</span> <span class="math notranslate nohighlight">\(&lt;\)</span> g<span class="math notranslate nohighlight">\(_A\)</span>. To maintain hydrostatic equilibrium, the distance between the pressure contours must increase so that dz<span class="math notranslate nohighlight">\(_B\)</span> <span class="math notranslate nohighlight">\(&gt;\)</span> dz<span class="math notranslate nohighlight">\(_A\)</span>.</p>
<p>This results in a flared pressure contour. As cylindrical radius increases linearly, the increase in the distance between the pressure contours is not linear. Gravitational forces decrease with increasing cylindrical radius more quickly than pressure forces do, allowing fluid at a given pressure to settle into hydrostatic equilibrium at increasingly higher z for greater r<span class="math notranslate nohighlight">\(_{xy}\)</span>.</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="04How_Do_Synestias_Form.html" title="previous page">How Do Synestias Form? (Giant Impacts)</a>
    <a class='right-next' id="next-link" href="06Gas_Drag_on_Moons_in_Synestias.html" title="next page">Gas Drag on Moons in Synestias</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Gigja O. Hollyday (edited by S. T. Stewart)<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.30270b6e4c972e43c488.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-15464495-6', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>